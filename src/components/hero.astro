---
import Calendario from "./calendario/Calendario.astro"
---
    
<div class="hero">
  <hgroup class="hero__hgroup">
    <h1><span>Hoy es</span> <time id="hoy-es-si"></time></h1>
    <p>segÃºn el</p>
    <cite>Calendario Mundial</cite>
  </hgroup>
  
  <div class="hero__textos">
      <p>Â¿Imaginas un calendario simple, ordenado y equilibrado?</p>
      <p>El Calendario Mundial es una propuesta diseÃ±ada para superar
      el calendario actual, simplificando nuestro sistema de tiempo.</p>
      
  </div> 
  <a class="hero__a" href="/about">Descubrir mÃ¡s</a>          
</div>
<Calendario />




<style>
  .hero {
    /* ðŸ“± Estilos base: mÃ³vil (â‰¤600px) */
    text-align: center;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    padding: 1rem;
    color: #fff;
    justify-content: center;
    align-items: center;


    /* ðŸ“² Tablet: 601px â€“ 1024px */
    @media (min-width: 601px) and (max-width: 1024px) {
    } 
    /* ðŸ’» Desktop: â‰¥1025px */
    @media (min-width: 1025px) {
      width: 80%;
      margin-left: auto;
      margin-right: auto;
    }
  }

  .hero__hgroup {
    margin-bottom: 1rem;
    span {
      display: block;
      font-size: 1rem;
    }
    cite {
      font-size: 2rem;
    }
  }

  .hero__a {
    background-color: #eb5d1e;
    display: inline-block;
    text-align: center;
    text-justify: center;
    color: #f9f9f9;
    font-family: "Playfair Display";
    text-decoration: none;
    border-radius: 25px;
    margin-top: 3rem;
    justify-self: center;
    margin-left: auto;
    margin-right: auto;
    padding-top: 0.5rem;
    padding-bottom: 0.5rem;
    padding-left: 1rem;
    padding-right: 1rem;
  }
  



#hoy-es-no {
  text-decoration: line-through;
}

#hoy-es-si {
  font-size: 2rem;
}

.hoy-es-si p {
  font-size: 1rem;
}



</style>

<script is:inline>
  // --- funciones puras (sin tocar el DOM) ---
  function calcularDiaOrdinal(fecha) {
    const diaUno = new Date(fecha.getFullYear(), 0, 1);
    return Math.floor((fecha - diaUno) / (1000 * 60 * 60 * 24)) + 1;
  }
  function esBisiesto(aÃ±o) {
    return (aÃ±o % 4 === 0 && aÃ±o % 100 !== 0) || aÃ±o % 400 === 0;
  }
  function construirTextoFecha() {
    const hoy = new Date();
    const aÃ±o = hoy.getFullYear();
    const diaOrdinal = calcularDiaOrdinal(hoy);
    const diaOrdinalB = diaOrdinal - 1;

    let nums = esBisiesto(aÃ±o)
      ? [0,31,61,91,122,152,183,214,244,274,305,335,366]
      : [0,31,61,91,122,152,182,213,243,273,304,334,365];

    let inicioMes = 0;
    function obtenerMes(d) {
      for (let i = 1; i < nums.length; i++) {
        if (d > nums[i-1] && d <= nums[i]) {
          inicioMes = nums[i-1];
          return i;
        }
      }
      return 1;
    }

    const dias = ["Lunes","Martes","MiÃ©rcoles","Jueves","Viernes","SÃ¡bado","Domingo"];
    const meses = ["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];

    const mesNombre = meses[obtenerMes(diaOrdinal) - 1];
    const diaMes = diaOrdinal - inicioMes;
    const diaSemana = dias[(diaOrdinal - 1) % 7];
    const diaSemanaB = dias[(diaOrdinalB - 1) % 7];

    if (esBisiesto(aÃ±o)) {
      if (diaOrdinal < 183) return `${diaSemana} ${diaMes} de ${mesNombre} de ${aÃ±o}`;
      if (diaOrdinal === 183) return `el dÃ­a del AÃ±o Bisiesto de ${aÃ±o}`;
      if (diaOrdinal > 183 && diaOrdinal < 366) return `${diaSemanaB} ${diaMes} de ${mesNombre} de ${aÃ±o}`;
      if (diaOrdinal === 366) return `el dÃ­a del Mundo de ${aÃ±o}`;
    } else {
      if (diaOrdinal === 365) return `el dÃ­a del Mundo de ${aÃ±o}`;
      return `${diaSemana} ${diaMes} de ${mesNombre} de ${aÃ±o}`;
    }
    return "";
  }

  // --- init/cleanup ligados al router ---
  function initFecha() {
    const el = document.getElementById("hoy-es-si");
    if (!el) return;
    // evita doble init si vuelves a esta pÃ¡gina
    if (el.dataset.bound === "true") return;
    el.dataset.bound = "true";
    el.textContent = construirTextoFecha();
  }

  function cleanupFecha() {
    const el = document.getElementById("hoy-es-si");
    if (!el) return;
    delete el.dataset.bound;
  }

  // eventos del ClientRouter (View Transitions)
  document.addEventListener("astro:page-load", initFecha);
  document.addEventListener("astro:after-swap", initFecha);
  document.addEventListener("astro:before-swap", cleanupFecha);

  // opcional si no usamos ClientRouter
  // document.addEventListener("DOMContentLoaded", initFecha)
</script>